- 웹스코프는 웹 환경에서만 동작한다.
- 웹 스코프는 프토타입과 다르게 스프링이 해당 스코프의 종료시점까지 관리한다. 따라서 종료 메서드가 호출된다.

### 웹 스코프 종류

- Request : HTTP 요청 하나가 들어오고 나갈 때 까지 유지되는 스코프, 각각의 HTTP 요청마다 별도의 빈 인스턴스가 생성되고, 관리된다.
- session : HTTP Session과 동일한 생명주기를 가지는 스코프
- application : 서블릿 컨텍스트와 동일한 생명주기를 가지는 스코프
- websocket : 웹 소켓과 동일한 생명주기를 가지는 스코프

![[Pasted image 20221223194438.png]]


### 스코프와 프록시

![[Pasted image 20221223194621.png]]
- 적용 대상이 클래스면 TARGET_CLASS
- 적용 대상이 인터페이스면 TARGET_INTERFACES
- 이렇게 하면 MyLogger의 가자 프록시 클래스를 만들어두고 HTTP request 와 상관 없이 가짜 프록시 클래스를 다른 빈에 미리 주입해 둘 수 있다.


#### CGLIB라는 라이브러리로 내 클래스를 상속 받은 가짜 프록시 객체를 만들어 주입한다. 의존관계 주입시 가짜 프록시 객체가 주입

![[Pasted image 20221223194916.png]]

- 가짜 프록시 객체는 요청이 오면 그때 내부에서 진짜 빈을 요청하는 위임 로직이 들어 있다.

### 동작 원리
- CGLIB 라는 라이브러리로 내 클래스를 상속 받은 갖짜 프록시 객체를 만들어 주입
- 가짜 프록시 객체는 실제 요청이 오면 그때 내부에서 실제 빈을 요청하는 위임 로직이 들어 있다.
- 가짜 프록시 객체는 실제 request scope와는 관계가 없다. 그냥 가짜이고, 내부에 단순한 위임 로직만 있고, 싱글톤 처럼 동작한다.

### 특징
- 프록시 객체 덕분에 클라이언트는 마치 싱글톤 빈을 사용하듯이 편리하게 request scope를 사용할 수 있다.
- 애노테이션 설정 변경만으로 원본 객체를 프록시 객체로 대체할 수있다. 이것이 바로 다형성과 DI 컨테이너가 가진 강점
- 웹 스코프가 아니더라도 프록시는 사용 가능

### 주의점
- 마치 싱글톤을 사용하는 것 같지만 다르게 동작 주의 할것
- 이러한 scope 는 꼭 필요한 곳에만 최소화해서 사용하자. 무분별하게 사용하면 유지보수가 어려워짐